<!DOCTYPE html>
<html lang="en"><head><title>LEGv8</title><meta charset="utf-8"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Fira Code&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="LEGv8"/><meta property="og:description" content="Related Classes: EECS 370 LEGv8 is a subset of the ARMv8 ISA. It is simplified to make it easier to learn and understand in a classroom environment. It has 32 registers (X0-X31) and 64 bits in each register."/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="./static/icon.png"/><meta name="description" content="Related Classes: EECS 370 LEGv8 is a subset of the ARMv8 ISA. It is simplified to make it easier to learn and understand in a classroom environment. It has 32 registers (X0-X31) and 64 bits in each register."/><meta name="generator" content="Quartz"/><link href="./index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><script src="./prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("./static/contentIndex.json").then(data => data.json())</script></head><body data-slug="LEGv8"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title"><a href=".">UMich Course Notes</a></h1><div class="spacer mobile-only"></div><div class="search"><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="search-layout" data-preview="true"></div></div></div></div><div class="darkmode"><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Dark mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Light mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;cheatsheets&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;classes&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;exams&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;ia-applications&quot;,&quot;collapsed&quot;:true}]"><h1>Explorer</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="cheatsheets"><button class="folder-button"><span class="folder-title">cheatsheets</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="cheatsheets"><li><a href="./cheatsheets/EECS-281-Midterm-Cheat-Sheet" data-for="cheatsheets/EECS-281-Midterm-Cheat-Sheet">EECS 281 Midterm Cheat Sheet</a></li><li><a href="./cheatsheets/EECS-370-Midterm-Cheatsheet" data-for="cheatsheets/EECS-370-Midterm-Cheatsheet">EECS 370 Midterm Cheatsheet</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="classes"><button class="folder-button"><span class="folder-title">classes</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="classes"><li><a href="./classes/EECS-281" data-for="classes/EECS-281">Data Structures and Algorithms</a></li><li><a href="./classes/EECS-203" data-for="classes/EECS-203">Discrete Math</a></li><li><a href="./classes/EECS-376" data-for="classes/EECS-376">Foundations of Computer Science</a></li><li><a href="./classes/EECS-370" data-for="classes/EECS-370">Introduction to Computer Organization</a></li><li><a href="./classes/EECS-482" data-for="classes/EECS-482">Introduction to Operating Systems</a></li><li><a href="./classes/EECS-280" data-for="classes/EECS-280">Programming and Data Structures</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="exams"><button class="folder-button"><span class="folder-title">exams</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="exams"><li><a href="./exams/EECS-281-Midterm" data-for="exams/EECS-281-Midterm">EECS 281 Midterm</a></li><li><a href="./exams/EECS-370-Midterm" data-for="exams/EECS-370-Midterm">EECS 370 Midterm</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="ia-applications"><button class="folder-button"><span class="folder-title">ia-applications</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="ia-applications"><li><a href="./ia-applications/EECS-203-IA-Application-Video-Plan" data-for="ia-applications/EECS-203-IA-Application-Video-Plan">EECS 203 IA Application Video Plan</a></li><li><a href="./ia-applications/EECS-281-IA-Application-Video-Plan" data-for="ia-applications/EECS-281-IA-Application-Video-Plan">EECS 281 IA Application Video Plan</a></li></ul></div></li><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><a href="./Abstract-Data-Type-(ADT)" data-for="Abstract-Data-Type-(ADT)">Abstract Data Type (ADT)</a></li><li><a href="./Big-O-Notation" data-for="Big-O-Notation">Big-O Notation</a></li><li><a href="./Big-Omega" data-for="Big-Omega">Big-Omega</a></li><li><a href="./Caller-Save-vs-Callee-Save" data-for="Caller-Save-vs-Callee-Save">Caller Save vs Callee Save</a></li><li><a href="./Combinational-Logic" data-for="Combinational-Logic">Combinational Logic</a></li><li><a href="./Complexity-Analysis" data-for="Complexity-Analysis">Complexity Analysis</a></li><li><a href="./Deque" data-for="Deque">Deque</a></li><li><a href="./Finite-State-Machine-(FSM)" data-for="Finite-State-Machine-(FSM)">Finite State Machine (FSM)</a></li><li><a href="./Floating-Point-Numbers" data-for="Floating-Point-Numbers">Floating Point Numbers</a></li><li><a href="./Generating-Unique-Identifiers" data-for="Generating-Unique-Identifiers">Generating Unique Identifiers</a></li><li><a href="./Instruction-Set-Architecture-(ISA)" data-for="Instruction-Set-Architecture-(ISA)">Instruction Set Architecture (ISA)</a></li><li><a href="./LC2K" data-for="LC2K">LC2K</a></li><li><a href="./LC2K-Multi-Cycle-Datapath" data-for="LC2K-Multi-Cycle-Datapath">LC2K Multi-Cycle Datapath</a></li><li><a href="./LC2K-Single-Cycle-Datapath" data-for="LC2K-Single-Cycle-Datapath">LC2K Single-Cycle Datapath</a></li><li><a href="./LEGv8" data-for="LEGv8">LEGv8</a></li><li><a href="./Linking" data-for="Linking">Linking</a></li><li><a href="./Number-Bases" data-for="Number-Bases">Number Bases</a></li><li><a href="./Object-Files" data-for="Object-Files">Object Files</a></li><li><a href="./Pipelining" data-for="Pipelining">Pipelining</a></li><li><a href="./Priority-Queue" data-for="Priority-Queue">Priority Queue</a></li><li><a href="./Queue" data-for="Queue">Queue</a></li><li><a href="./Read-Only-Memory-(ROM)" data-for="Read-Only-Memory-(ROM)">Read Only Memory (ROM)</a></li><li><a href="./Registers" data-for="Registers">Registers</a></li><li><a href="./Sequential-Logic" data-for="Sequential-Logic">Sequential Logic</a></li><li><a href="./Stack" data-for="Stack">Stack</a></li><li><a href="./Trends-in-Computing" data-for="Trends-in-Computing">Trends in Computing</a></li><li><a href="./Two's-Complement-Numbers" data-for="Two's-Complement-Numbers">Two's Complement Numbers</a></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container" aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="./">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href>LEGv8</a></div></nav><h1 class="article-title">LEGv8</h1><p show-comma="true" class="content-meta"><span>Feb 28, 2024</span><span>8 min read</span></p><ul class="tags"><li><a href="./tags/eecs-370" class="internal tag-link">eecs-370</a></li></ul></div></div><article class="popover-hint"><p>Related Classes: <a href="./classes/EECS-370" class="internal alias" data-slug="classes/EECS-370">EECS 370</a></p>
<p>LEGv8 is a subset of the ARMv8 ISA. It is simplified to make it easier to learn and understand in a classroom environment.</p>
<p>It has 32 registers (<code>X0</code>-<code>X31</code>) and 64 bits in each register.</p>
<p>Some registers have special uses: <code>X31</code> is always 0 (also called <code>XZR</code>)</p>
<p>LEG is byte addressable</p>
<h2 id="arm-instruction-set">ARM Instruction Set<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#arm-instruction-set" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ol>
<li>Arithmetic
<ul>
<li>Add</li>
<li>Subtract</li>
</ul>
</li>
<li>Data Transfer
<ul>
<li>Loads and Stores—LDUR (load unscaled register), STUR, etc</li>
</ul>
</li>
<li>Logical
<ul>
<li>AND, ORR, EOR, etc.</li>
<li>Logical Shifts (LSL, LSR)</li>
</ul>
</li>
<li>Conditional Branch
<ul>
<li>CBZ, CBNZ, B.cond</li>
</ul>
</li>
<li>Unconditional Branch (jumps)
<ul>
<li>B, BR, BL</li>
</ul>
</li>
</ol>
<h2 id="arithmetic-instructions-r-instructions">Arithmetic Instructions (R Instructions)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#arithmetic-instructions-r-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Format: 3 Operand Fields</p>
<ul>
<li><strong>Destination Register is the FIRST ONE</strong></li>
<li><code>ADD X3, X4, X7 // X3 = X4 + X7</code></li>
</ul>
<p>Encoding given <code>R[Rd] = R[Rn] + R[Rm]</code> (in the add case):</p>
<ul>
<li><code>opcode</code>: 11 bits</li>
<li><code>Rm</code>: 5 bits</li>
<li><code>shamt</code>: 6 bits</li>
<li><code>Rn</code>: 5 bits</li>
<li><code>Rd</code>: 5 bits</li>
</ul>
<h2 id="legv8-logical-instructions">LEGv8 Logical Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#legv8-logical-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>Logical operations are bit-wise</li>
<li>For immediate fields, the 12 bit constant is padded with zeros to the left</li>
</ul>
<h3 id="legv8-shift-logical-instructions">LEGv8 Shift Logical Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#legv8-shift-logical-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h2 id="pseudo-instructions">Pseudo-Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#pseudo-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<ul>
<li>Instructions that use a shorthand “mnemonic” that expands to pre-existing assembly instructions</li>
<li>Examples:
<ul>
<li><code>MOV X12, X2 // copy X2 into X12</code> <span>⇒</span> <code>ORR X12, XZR, X2</code></li>
<li><code>MOVZ X12, #23 // set X12 to be 23</code> <span>⇒</span> <code>ORRI X12, XZR, #23</code></li>
</ul>
</li>
</ul>
<h2 id="memory-instructions">Memory Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#memory-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Unlike <a href="./LC2K" class="internal" data-slug="LC2K">LC2K</a>ISAs]]) is <em><strong>byte</strong></em> addressable. Recall that a word is four bytes.</p>
<p>Just like <a href="./LC2K" class="internal" data-slug="LC2K">LC2K</a>, ARM uses a base + displacement mode. However, in ARM, you can transfer different sizes (instead of the whole 64 bit value). This way, it lets us deal with non-64 bit values.</p>
<h3 id="loads">Loads<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#loads" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>When we’re loading smaller elements from memory, there are two options on what to do with the other bits:</p>
<ul>
<li>Set them to zero, or <em>zero-extend</em></li>
<li>Sign-extend (extend based on the most significant bit)
ARM has different instructions for each option so the processor knows what to do.</li>
</ul>






























<div class="table-container"><table><thead><tr><th>Desired amount of data to transfer</th><th>Operation</th><th>Unused bits in register</th></tr></thead><tbody><tr><td>64-bits (double word, or whole register)</td><td><code>LDUR</code></td><td>N/A</td></tr><tr><td>16-bits (half-word) into the lower bits of register</td><td><code>LDURH</code></td><td>Set to zero</td></tr><tr><td>8-bits (byte) into lower bits of register</td><td><code>LDURB</code></td><td>Set to zero</td></tr><tr><td>32-bits (word) into lower bits of register</td><td><code>LDURSW</code> (load <strong>signed</strong> word)</td><td>Sign extend (0 or 1 based on the most significant bit)</td></tr></tbody></table></div>
<h3 id="stores">Stores<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#stores" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>For stores, signedness doesn’t actually matter: you’re storing exactly what you said, there’s no extension necessary (or even relevant).</p>
<h2 id="sequencing-instructions-control-flow-instructions">Sequencing Instructions (Control Flow Instructions)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#sequencing-instructions-control-flow-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Sequencing Instructions change the flow of instructions that are executed. This is achieved by modifying the program counter (PC).</p>
<h3 id="conditional-instructions">Conditional Instructions<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#conditional-instructions" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<h4 id="type-1-compare-to-zero">Type 1: Compare to Zero<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#type-1-compare-to-zero" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>The first type of Conditional Instruction is comparing to zero, and then branching. This includes <code>CBZ</code> and <code>CBNZ</code>.</p>




















<div class="table-container"><table><thead><tr><th>Instruction</th><th>Example</th><th>What it does</th></tr></thead><tbody><tr><td><code>CBZ</code></td><td><code>CBZ X1, 25</code></td><td>If the value in the specified register equals zero, then adjust the program counter by that many lines (multiply by four to get number of bytes)</td></tr><tr><td><code>CBNZ</code></td><td><code>CBNZ X1, 25</code></td><td>If the value in the specified register does not equal zero, then adjust the PC…</td></tr></tbody></table></div>
<h3 id="type-2-program-status-register-non-zero-equality-comparisons">Type 2: Program Status Register (non-zero equality comparisons)<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#type-2-program-status-register-non-zero-equality-comparisons" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Sometimes, you want to do comparisons that are not just equal to zero. For example, <code>a > b</code>, or <code>a = b</code> where <code>b</code> is a variable, etc. ARM allows us to this with with flags.</p>
<p>The flags used in ARM for this are <code>NZVC</code>, or Negative, Zero, oVerflow, and Carry. If you run an instruction that also sets a flag, this can then be referenced in a subsequent branch instruction (reference <code>ADDS</code>, <code>SUBS</code>, anything that ends in <code>S</code>).</p>
<p>For <a href="./classes/EECS-370" class="internal alias" data-slug="classes/EECS-370">EECS 370</a>, we’ll focus on N and Z.</p>
<p>While you can use arithmetic operations to set flags (which can save on lines of assembly), the most common way to set a flag is to use the <code>CMP</code> pseudo-instruction. This updates all the flags to allow you to use the correct type of branching.</p>
<h2 id="c-to-assembly">C to Assembly<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#c-to-assembly" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>When converting C code to LEG code, there are few important things that you need to keep in mind:</p>
<ul>
<li>At least for <a href="./classes/EECS-370" class="internal alias" data-slug="classes/EECS-370">EECS 370</a>, exams will include doing operations on values that a certain size, and then storing them into items of another size. Being careful about the sizes is important</li>
</ul>
<h3 id="example-conversion-1">Example Conversion 1<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-conversion-1" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>C Code:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c" data-theme="github-light github-dark"><code data-language="c" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> a; </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">unsigned</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> b, c; } y;</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">y.a </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y.b </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y.c;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // NOTE: a is an integer (32 bits), while b and c are bytes (4 bits)</span></span></code></pre></figure>
<p>Assembly</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="assembly" data-theme="github-light github-dark"><code data-language="assembly" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>/* Assume that a pointer to y is in X1 */</span></span>
<span data-line><span>LDURB X2, [X1, #4] ; it starts 4 bytes after the start of the struct</span></span>
<span data-line><span>LDURB X3, [X1, #5]</span></span>
<span data-line><span>ADD X4, X2, X3</span></span>
<span data-line><span>STURW X4, [X1, #0] ; STURW stores four bytes, or a single word</span></span></code></pre></figure>
<h3 id="memory-alignment">Memory Alignment<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#memory-alignment" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>When dealing with a variables in C or C++, we often need to include padding between data members to make sure things are properly aligned (to help modern hardware access things quickly and efficiently).</p>
<p>This means that, even though a struct looks like it only is using, say, 7 bytes of data, it might under the hood actually be using 12 bytes because of alignment.</p>
<p>Modern ISAs enforce the following requirement: an <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>-byte variable must start at an address <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span> such that <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">A</span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin"><span class="mord"><span class="mord mathrm">mod</span></span></span><span class="mspace" style="margin-right:0.0556em;"></span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord"><span class="mord mathnormal">n</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>. This is called the “Golden Rule of Alignment”</p>
<h4 id="memory-alignment-example">Memory Alignment Example<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#memory-alignment-example" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h4>
<p>Say we have the following C Code:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c" data-theme="github-light github-dark"><code data-language="c" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">char</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   c;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">short</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  s;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    i;</span></span></code></pre></figure>
<p>The following memory layout would be created</p>

























<div class="table-container"><table><thead><tr><th><code>0x1000</code></th><th><code>0x1001</code></th><th><code>0x1002</code></th><th><code>0x1003</code></th><th><code>0x1004</code></th><th><code>0x1005</code></th><th><code>0x1006</code></th><th><code>0x1007</code></th></tr></thead><tbody><tr><td><code>[c]</code></td><td>PADDING</td><td><code>[s]</code></td><td><code>[s]</code></td><td><code>[i]</code></td><td><code>[i]</code></td><td><code>[i]</code></td><td><code>[i]</code></td></tr></tbody></table></div>
<p>So this ends up being eight bytes long. If the compiler can not change the order of fields, and the <code>short</code> and <code>int</code> declarations were swapped, this same “structure” would take 10 bytes of memory instead.</p>
<h3 id="aligning-arrays">Aligning Arrays<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#aligning-arrays" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>We treat arrays like they’re just multiple of the original type, and align the start of the array accordingly.</p>
<h3 id="aligning-structs">Aligning Structs<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#aligning-structs" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>Structs start to break things. Specifically, in the case where you have an array of structs. Following the above procedure, we’d end up with different padding gaps between different structs, which makes it very difficult (if not impossible) to be able to navigate within the array.</p>
<p>This requires an addition to the golden rule: identify the largest primitive field, and ensure that the starting address of the overall struct is aligned based on that largest field (and add padding to the back so that the total size is a multiple of the largest primitive).</p>
<h3 id="example-conversion-2-branching">Example Conversion 2: Branching<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-conversion-2-branching" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>C Code</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c" data-theme="github-light github-dark"><code data-language="c" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x, y;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // assume x is in X1, y is in X2</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> y)</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	x</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	y</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></figure>
<p>Assembly Code</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="assembly" data-theme="github-light github-dark"><code data-language="assembly" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>	CMP X1, X2</span></span>
<span data-line><span>	B.EQ if</span></span>
<span data-line><span>else:</span></span>
<span data-line><span>	ADD X2, X2, #1</span></span>
<span data-line><span>	B end ; unconditionally branch to end</span></span>
<span data-line><span>if:</span></span>
<span data-line><span>	ADD X1, X1, #1 ; the # symbol makes it so that you don't need to specify ADDI</span></span>
<span data-line><span>end:</span></span></code></pre></figure>
<p>Also Valid Assembly Code</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="assembly" data-theme="github-light github-dark"><code data-language="assembly" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>	CMP X1, X2</span></span>
<span data-line><span>	B.NEQ else</span></span>
<span data-line><span>if:</span></span>
<span data-line><span>	ADD X1, X1, #1</span></span>
<span data-line><span>	B end</span></span>
<span data-line><span>else:</span></span>
<span data-line><span>	ADD X2, X2, #1</span></span>
<span data-line><span>end:</span></span></code></pre></figure>
<h3 id="example-conversion-3-loops">Example Conversion 3: Loops<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#example-conversion-3-loops" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>C Code</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="c" data-theme="github-light github-dark"><code data-language="c" data-theme="github-light github-dark" style="display:grid;"><span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// assume all vraibles are long lon integers (8 bytes, 64 bits)</span></span>
<span data-line><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// i is in X1, start of a is at address 100, and sum is in X2</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">++</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[i] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">>=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		sum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+=</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> a</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[i];</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span data-line><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></figure>
<p>Assembly Code:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="assembly" data-theme="github-light github-dark"><code data-language="assembly" data-theme="github-light github-dark" style="display:grid;"><span data-line><span>	MOVZ X2, #0 ; set sum to zero</span></span>
<span data-line><span>	MOVZ X1, #0</span></span>
<span data-line><span>start:</span></span>
<span data-line><span>	CMPI X1, #10 ; compare i to 10</span></span>
<span data-line><span>	B.GE end</span></span>
<span data-line><span>	LSL X3, X1, #3 ; we need to increment by eight bytes</span></span>
<span data-line><span>	LDUR X3, [X3, #100] ; load the current value of a[i]</span></span>
<span data-line><span>	CMPI X3, #0</span></span>
<span data-line><span>	B.LT elseif ; if it's not geq 0, then continue</span></span>
<span data-line><span>	ADD X2, X2, X3 ; add value to sum</span></span>
<span data-line><span>elseif:</span></span>
<span data-line><span>	ADD X1, X1, #1 ; increment i</span></span>
<span data-line><span>	B start ; start from start</span></span>
<span data-line><span>end:</span></span></code></pre></figure>
<h2 id="function-calls">Function Calls<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#function-calls" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h2>
<p>Sometimes, function calls can be very far away: more than the <span class="katex"><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord">2</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">19</span></span></span></span></span></span></span></span></span></span></span></span> instructions that a typical <code>CBZ</code> or <code>CBNZ</code> branching instruction might take. This is where unconditional branching comes into play, to let us unconditionally go to far locations.</p>
<p>Since unconditional branches are, well, <em>unconditional</em>, no other registers need to be specified, so they allow us to specify an address up to <em>26</em> bits away, which is more than 64 million instructions. This should be plenty.</p>
<p>There are three types of unconditional branches in the LEGv8 ISA:</p>
<ul>
<li>Branch: <code>B</code>
<ul>
<li>Syntax: <code>B #OFFSET</code> <span>→</span> go to <code>PC + 4 * OFFSET</code> (byte addressable)</li>
</ul>
</li>
<li>Branch to Register: <code>BR</code>
<ul>
<li>Syntax: <code>BR X30</code> (or any other register) <span>→</span> go to the address stored in that register</li>
</ul>
</li>
<li>Branch with link: <code>BL</code>
<ul>
<li>This is commonly used in function calls</li>
<li><code>BL #OFFSET</code> <span>→</span> Store PC + 4 into <code>X30</code> and go to <code>PC + 4 * OFFSET</code></li>
</ul>
</li>
</ul>
<h3 id="the-call-stack">The Call Stack<a role="anchor" aria-hidden="true" tabindex="-1" data-no-popover="true" href="#the-call-stack" class="internal"><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path></svg></a></h3>
<p>In many situations, functions might be “passed in” data that is more than can fit in however many registers can be used to get data passed in. There needs to be a temporary place to store these values when they get passed to the function: the solution is the calls stack.</p>
<p>Think of the call stack as a stack of scratch paper: you can add more on top and use it and scribble things on top of it, but it is really all just temporary. When you’re done with a piece of paper, you can throw it out, shred it, and eliminate any trace that it was actually there.</p>
<p>Every time we call a function, a <strong>stack frame</strong> is allocated for that function, and then discarded when that function is complete.</p></article></div><div class="right sidebar"><div class="graph"><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:false}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[],&quot;focusOnHover&quot;:true}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#arm-instruction-set" data-for="arm-instruction-set">ARM Instruction Set</a></li><li class="depth-0"><a href="#arithmetic-instructions-r-instructions" data-for="arithmetic-instructions-r-instructions">Arithmetic Instructions (R Instructions)</a></li><li class="depth-0"><a href="#legv8-logical-instructions" data-for="legv8-logical-instructions">LEGv8 Logical Instructions</a></li><li class="depth-1"><a href="#legv8-shift-logical-instructions" data-for="legv8-shift-logical-instructions">LEGv8 Shift Logical Instructions</a></li><li class="depth-0"><a href="#pseudo-instructions" data-for="pseudo-instructions">Pseudo-Instructions</a></li><li class="depth-0"><a href="#memory-instructions" data-for="memory-instructions">Memory Instructions</a></li><li class="depth-1"><a href="#loads" data-for="loads">Loads</a></li><li class="depth-1"><a href="#stores" data-for="stores">Stores</a></li><li class="depth-0"><a href="#sequencing-instructions-control-flow-instructions" data-for="sequencing-instructions-control-flow-instructions">Sequencing Instructions (Control Flow Instructions)</a></li><li class="depth-1"><a href="#conditional-instructions" data-for="conditional-instructions">Conditional Instructions</a></li><li class="depth-1"><a href="#type-2-program-status-register-non-zero-equality-comparisons" data-for="type-2-program-status-register-non-zero-equality-comparisons">Type 2: Program Status Register (non-zero equality comparisons)</a></li><li class="depth-0"><a href="#c-to-assembly" data-for="c-to-assembly">C to Assembly</a></li><li class="depth-1"><a href="#example-conversion-1" data-for="example-conversion-1">Example Conversion 1</a></li><li class="depth-1"><a href="#memory-alignment" data-for="memory-alignment">Memory Alignment</a></li><li class="depth-1"><a href="#aligning-arrays" data-for="aligning-arrays">Aligning Arrays</a></li><li class="depth-1"><a href="#aligning-structs" data-for="aligning-structs">Aligning Structs</a></li><li class="depth-1"><a href="#example-conversion-2-branching" data-for="example-conversion-2-branching">Example Conversion 2: Branching</a></li><li class="depth-1"><a href="#example-conversion-3-loops" data-for="example-conversion-3-loops">Example Conversion 3: Loops</a></li><li class="depth-0"><a href="#function-calls" data-for="function-calls">Function Calls</a></li><li class="depth-1"><a href="#the-call-stack" data-for="the-call-stack">The Call Stack</a></li></ul></div></div><div class="backlinks"><h3>Backlinks</h3><ul class="overflow"><li><a href="./Instruction-Set-Architecture-(ISA)" class="internal">Instruction Set Architecture (ISA)</a></li><li><a href="./cheatsheets/EECS-370-Midterm-Cheatsheet" class="internal">EECS 370 Midterm Cheatsheet</a></li><li><a href="./exams/EECS-370-Midterm" class="internal">EECS 370 Midterm</a></li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v0.0.1</a> © 2024</p><ul><li><a href="https://github.com/bansalsh-umich/course-notes">GitHub</a></li></ul></footer></div></body><script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">function c(){let t=this.parentElement;t.classList.toggle("is-collapsed");let l=t.classList.contains("is-collapsed")?this.scrollHeight:t.scrollHeight;t.style.maxHeight=l+"px";let o=t,e=t.parentElement;for(;e;){if(!e.classList.contains("callout"))return;let n=e.classList.contains("is-collapsed")?e.scrollHeight:e.scrollHeight+o.scrollHeight;e.style.maxHeight=n+"px",o=e,e=e.parentElement}}function i(){let t=document.getElementsByClassName("callout is-collapsible");for(let s of t){let l=s.firstElementChild;if(l){l.addEventListener("click",c),window.addCleanup(()=>l.removeEventListener("click",c));let e=s.classList.contains("is-collapsed")?l.scrollHeight:s.scrollHeight;s.style.maxHeight=e+"px"}}}document.addEventListener("nav",i);window.addEventListener("resize",i);
</script><script type="module">
          let mermaidImport = undefined
          document.addEventListener('nav', async () => {
            if (document.querySelector("code.mermaid")) {
              mermaidImport ||= await import('https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.7.0/mermaid.esm.min.mjs')
              const mermaid = mermaidImport.default
              const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
              mermaid.initialize({
                startOnLoad: false,
                securityLevel: 'loose',
                theme: darkMode ? 'dark' : 'default'
              })

              await mermaid.run({
                querySelector: '.mermaid'
              })
            }
          });
          </script><script type="application/javascript">
            const socket = new WebSocket('ws://localhost:3001')
            // reload(true) ensures resources like images and scripts are fetched again in firefox
            socket.addEventListener('message', () => document.location.reload(true))
          </script><script src="./postscript.js" type="module"></script></html>